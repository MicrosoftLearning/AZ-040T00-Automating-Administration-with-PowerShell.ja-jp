---
lab:
  title: 'ラボ: PowerShell を使用したローカル システム管理の実行'
  module: 'Module 2: Windows PowerShell for local systems administration'
---

# ラボ: PowerShell を使用したローカル システム管理の実行

このラボは完了するまで、約 **60** 分かかります。

## シナリオ

あなたは、Adatum Corporation のサーバー サポート チームで働いています。 最初の業務の 1 つは、新しいブランチ オフィスのインフラストラクチャ サービスを構成する方法です。 Windows PowerShell を使用してタスクを完了することに決定しました。

## 目標

このラボを完了すると、次のことができるようになります。

- Windows PowerShell を使用して Active Directory オブジェクトを作成して管理する。
- Windows PowerShell を使用して、Windows Server でネットワーク設定を構成する。
- Windows PowerShell を使用して、インターネット インフォメーション サービス (IIS) Web サイトを作成します。

## ラボのセットアップ

仮想マシン: **AZ-040T00A-LON-DC1**、**AZ-040T00A-LON-SVR1**、および **AZ-040T00A-LON-CL1**

ユーザー名: **Adatum\\Administrator**

パスワード: **Pa55w.rd**

## ラボのスタートアップ

1. **[LON-DC1]** を選択します。
1. 次の資格情報を使用してサインインします。

   - ユーザー名: **Administrator**
   - パスワード: **Pa55w.rd**
   - ドメイン: **Adatum**

1. **LON-CL1** と **LON-SVR1** についても同じ手順を繰り返します。

## 演習 1:Active Directory オブジェクトの作成と管理

### 演習のシナリオ 1

この演習では、Active Directory オブジェクトを作成および管理して、ブランチ オフィスの組織単位 (OU) と OU 管理者のグループを作成します。 ブランチ オフィスの既定の OU でユーザーおよびコンピューターのアカウントを作成し、そのユーザーを administrators グループに追加します。 後で、ブランチ オフィス用に作成した OU にユーザーとコンピューターを移動します。 個々の Windows PowerShell コマンドを使用して、クライアント コンピューターからこれらのタスクを実行します。

この演習の主なタスクは次のとおりです。

1. ブランチ オフィス用の新しい OU を作成する。
1. ブランチ オフィスの管理者のグループを作成する。
1. ブランチ オフィスのユーザーとコンピューター アカウントを作成する。
1. グループ、ユーザー、コンピューター アカウントをブランチ オフィス OU に移動する。

### タスク 1: ブランチ オフィス用の新しい OU を作成する

- **[LON-CL1]** から、Windows PowerShell を使用して **London** という名前の新しい OU を作成します。

### タスク 2: ブランチ オフィスの管理者のグループを作成する

- **PowerShell** コンソールで、**London Admins** グローバル セキュリティ グループを作成します。

### タスク 3: ブランチ オフィスのユーザーとコンピューター アカウントを作成する

1. **PowerShell** コンソールで、ユーザー **Ty Carlson** のユーザー アカウントを作成します。
2. **London Admins** グループにユーザーを追加します。
3. **LON-CL2** コンピューターのコンピューター アカウントを作成します。

### タスク 4: グループ、ユーザー、コンピューター アカウントをブランチ オフィス OU に移動する

- Windows PowerShell を使用して、次のグループ、ユーザー、およびコンピューターのアカウントを London OU に移動します。

  - **London Admins**
  - **Ty Carlson**
  - **LON-CL2**

### 演習 1 の結果

この演習を完了すると、Windows PowerShell コマンドライン インターフェイスで Active Directory オブジェクトを管理するためのコマンドを正しく識別して使用できるようになります。

## 演習 2:Windows Server でのネットワーク設定の構成

### 演習のシナリオ 2

この演習では、Windows Server でのネットワーク設定を構成します。 効果を確認するには、変更の前と後にネットワーク接続をテストします。 個々の Windows PowerShell コマンドを使用して、サーバー上でこれらのタスクを実行します。

この演習の主なタスクは次のとおりです。

1. ネットワーク接続をテストし、構成を確認する。
1. サーバーの IP アドレスを変更する。
1. サーバーの DNS 設定と既定のゲートウェイを変更する。
1. 変更を確認してテストする。

### タスク 1: ネットワーク接続をテストし、構成を確認する

1. **LON-SVR1** に切り替えます。
2. 管理者特権で Windows PowerShell を開きます。
3. **LON-DC1** への接続をテストし、応答の受信にかかる時間に注目します。
4. **LON-SVR1** のネットワーク構成を確認します。
5. IP アドレス、既定のゲートウェイ、DNS サーバーをメモします。

### タスク 2: サーバーの IP アドレスを変更する

- Windows PowerShell を使用して **Ethernet** ネットワーク インターフェイスの IP アドレスを **172.16.0.15/16** に変更します。

### タスク 3: サーバーの DNS 設定と既定のゲートウェイを変更する

1. **Ethernet** ネットワーク インターフェイスの DNS 設定を **172.16.0.12** を指すように変更します。
2. **Ethernet** ネットワーク インターフェイスの既定のゲートウェイを **172.16.0.2** に変更します。

### タスク 4: 変更を確認してテストする

1. **LON-SVR1** で、ネットワーク構成への変更を確認します。
2. **LON-DC1** への接続をテストし、応答の受信にかかる時間の違いに注目します。

### 演習 2 の結果

この演習を完了すると、ネットワーク構成を管理するための Windows PowerShell コマンドを正しく識別して使用できます。

## 演習 3:Web サイトを作成する

### 演習のシナリオ 3

この演習では、Web サーバー (IIS) サーバーの役割をインストールし、ロンドン ブランチ用の新しい内部 Web サイトを作成します。 個々の Windows PowerShell コマンドを使用して、サーバー上でこれらのタスクを実行します。

この演習の主なタスクは次のとおりです。

1. サーバーに Web サーバー (IIS) の役割をインストールする。
1. Web サイトのファイル用のフォルダーをサーバーに作成する。
1. IIS Web サイトを作成する。

### タスク 1: サーバーに Web サーバー (IIS) の役割をインストールする

- **LON-SVR1** で、Windows PowerShell を使用して **LON-SVR1** に Web サーバー (IIS) の役割をインストールします。

### タスク 2: Web サイトのファイル用のフォルダーをサーバーに作成する

- **LON-SVR1** では、PowerShell を使用して、Web サイト ファイルの **C:\inetpub\wwwroot** の下に、**London** という名前のフォルダーを作成します。

### タスク 3: IIS Web サイトを作成する

1. **LON-SVR1** では、PowerShell を使用して、次の構成を使用して IIS Web サイトを作成します。

    - 名前: **London**
    - 物理パス: 以前に作成したフォルダー
    - バインド情報: ポート **8080** を使用した **LON-SVR1** の現在の IP アドレス

1. IP アドレスとポート **8080** を使用して Internet Explorer で Web サイトを開き、指定された設定がサイトで使用されていることを確認します。 Internet Explorer から、URL に対してドキュメントが構成されていないというエラー メッセージが表示されます。 エラー メッセージの詳細に、サイトの物理パスが表示されます。これは、**C:\\inetpub\\wwwroot\\London** になります。

### 演習 3 の結果

この演習を完了すると、標準化された Web サーバー構成の一部として使用される Windows PowerShell コマンドを正しく識別して使用できます。
